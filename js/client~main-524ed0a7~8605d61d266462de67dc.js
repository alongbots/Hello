try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="3da59da8-3daa-47a8-84fe-6ca9fa0e4f53",e._sentryDebugIdIdentifier="sentry-dbid-3da59da8-3daa-47a8-84fe-6ca9fa0e4f53")}catch(e){}("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{}).SENTRY_RELEASE={id:"d8ea849a8f6630d596dadf4704adb6de069d21ff"};(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[8342],{5298:(e,t,a)=>{a.d(t,{$B:()=>O,Ay:()=>$,Ee:()=>I,FR:()=>D,K5:()=>A,KO:()=>z,N2:()=>P,Qk:()=>S,Sk:()=>N,Ue:()=>L,Vv:()=>M,Xk:()=>b,ZI:()=>F,_n:()=>k,hj:()=>B,mX:()=>_,nK:()=>T,tM:()=>E,yT:()=>x,yc:()=>h});var o=a(20038),n=a(8120),s=a(91323),i=a(61481),r=a(42891),l=a(98708),c=a(15049),d=a(53210),g=a(11436),u=a(43908),m=a(36774),p=a(40890),f=a(35190);const y=["GB","ES"],v={pokifordevs_team_id:void 0,developer:void 0},h=(0,o.VP)("pages/getPageDone"),_=(0,o.VP)("pages/not_found"),w=(0,o.Z0)({name:"pages",initialState:{currentPagePath:null,previousPagePath:null,isLanding:!0,pages:{}},reducers:{setIsLanding:(e,t)=>{e.isLanding=t.payload.isLanding}},extraReducers:e=>{e.addCase(h,((e,t)=>{const{path:a,pokifordevs_team_id:o,developer:n}=t.payload,s=e.pages&&e.pages[a]||v;e.pages={...e.pages,[a]:{...s,pokifordevs_team_id:o,developer:n}},e.previousPagePath=e.currentPagePath,e.currentPagePath=a}))}}),{setIsLanding:k}=w.actions;function S(e){return e.router.location.pathname}function b(e){return e.pages?.isLanding}const A=(0,n.Mz)(s.Gd,S,((e,t)=>(0,p.M5)(e,t)));function L(e){const{pages:t}=e,a=S(e),o=function(e){return e.pages?.previousPagePath||null}(e),n=t?.pages?.[a],s=o?t?.pages?.[o]:null;return n?.pokifordevs_team_id&&s?.pokifordevs_team_id?n.pokifordevs_team_id===s.pokifordevs_team_id:!(!n?.developer||!s?.developer)&&n.developer===s.developer}const C=e=>i.lh.endpoints.getGame.select({slug:(0,g.Ms)(e),site:(0,s.Gd)(e),device:(0,r.xp)(e),geo:(0,r.wu)(e),experiment:(0,d.p)(e),pageType:A(e),path:(0,g.k4)(e)})(e);function M(e){const t=A(e);if("game"!==t&&"preview"!==t&&"mystery"!==t)return{};const a=C(e);return"fulfilled"===a.status?a.data:{}}const P=e=>{if(!("category"===A(e)))return{};const t=(e=>i.lh.endpoints.getCategory.select({slug:(0,g.Ms)(e),site:(0,s.Gd)(e),device:(0,r.xp)(e),geo:(0,r.wu)(e),experiment:(0,d.p)(e)})(e))(e);return"fulfilled"===t.status?t.data:{}};function G(e){if(!("home"===A(e)))return{};const t=(e=>i.lh.endpoints.getHomepage.select({site:(0,s.Gd)(e),device:(0,r.xp)(e),geo:(0,r.wu)(e),experiment:(0,d.p)(e),trafficSource:(0,r.zO)(e)})(e))(e);return"fulfilled"===t.status?t.data:{}}const T=(0,n.Mz)(A,M,P,G,((e,t,a,o)=>{let n=[];return"game"===e&&"alternates"in t&&Array.isArray(t.alternates)&&(n=t.alternates),"category"===e&&"alternates"in a&&Array.isArray(a.alternates)&&(n=a.alternates),"home"===e&&"alternates"in o&&Array.isArray(o.alternates)&&(n=o.alternates),n.length>0?n.filter((({hrefLang:e})=>"x-default"!==e)).map((({href:e,hrefLang:t,lang:a,title:o})=>({href:e,hrefLang:t,title:o,lang:a,languageName:(0,u.sv)()[t]?.languageName}))).sort(((e,t)=>{const a=e.languageName||"",o=t.languageName||"";return a.localeCompare(o,"en")})):[]})),D=(0,n.Mz)(s.Gd,(e=>(0,p.AO)(e,"privacy",""))),E=(0,n.Mz)(s.Gd,r.wu,((e,t)=>"NL"===t?(0,p.AO)(e,"privacy",""):(0,p.AO)(e,"content",(m._k.includes(t)?"":"global-")+"privacy-statement"))),F=(0,n.Mz)(s.Gd,r.wu,((e,t)=>(0,p.AO)(e,"content",(m._k.includes(t)?"":"global-")+"cookie-statement"))),O=(0,n.Mz)(s.Gd,r.wu,((e,t)=>(0,p.AO)(e,"content",(m._k.includes(t)?"":"global-")+"terms-of-use"))),B=(0,n.Mz)(r.wu,(e=>!y.includes(e))),z=(0,n.Mz)(s.Gd,(e=>(0,p.AO)(e,"content","contact"))),I=(0,n.Mz)((()=>null),(()=>[{label:"TikTok",ariaLabel:"Poki TikTok",url:"https://www.tiktok.com/@poki_games",iconClass:"tiktok"},{label:"Instagram",ariaLabel:"Poki Instagram",url:"https://www.instagram.com/poki__games",iconClass:"instagram"},{label:"YouTube",ariaLabel:"Poki YouTube",url:"https://www.youtube.com/@Poki",iconClass:"youtube"}])),x=(0,n.Mz)(s.Gd,l.K,z,E,F,O,c.lb,r.wu,B,r.oJ,((e,t,a,o,n,s,i,r,l,c)=>({getToKnowUs:[{label:t.about,url:"https://about.poki.com",external:!0},{label:t.developers,url:"https://developers.poki.com",external:!0},i?null:{label:t.poki_kids,url:"https://kids.poki.com",external:!0},{label:t.jobs,url:"https://jobs.poki.com",external:!0}].filter(Boolean),privacyAndTerms:[!0===l?{label:t.privacy_center,url:(0,p.AO)(e,"privacy","")}:null,!1===l?{label:t.privacy_statement,url:o}:null,!1===l?{label:t.nav_terms_of_use,url:s}:null,i||l?null:{label:t.cookie_statement,url:n},"CA"===r?{label:`⚙️ ${t.cookie_settings}`,url:(0,p.AO)(e,"privacy","")}:null,m._k.includes(r)&&!i?{type:"button",label:t.cookie,action:f.e.OPEN_CMP,icon:"⚙️",ariaLabel:t.cookie}:null,c?{type:"button",label:"Do Not Sell My Data",action:f.e.OPEN_CCPA,icon:"⚙️",ariaLabel:"Do Not Sell My Data"}:null,"GB"===r?{type:"button",label:"Manage Consent",action:f.e.OPEN_GB_CONSENT}:null].filter(Boolean),helpAndSupport:[{label:t.faq,url:(0,p.AO)(e,"content","faq")},{label:t.nav_contact,url:a}].filter(Boolean)})));function N(e){const t=i.lh.endpoints.getImvitaConfigs.select({})(e);return"fulfilled"===t.status?t.data:{}}const $=w},15203:(e,t,a)=>{a.d(t,{Ay:()=>m,Bi:()=>g,ON:()=>f,QZ:()=>d,ht:()=>u});var o=a(20038),n=a(42891),s=a(61481),i=a(5298),r=a(11436),l=a(16536);const c=(0,o.Z0)({name:"mystery",initialState:{game:null,games:[],triggered:!1,canBeShown:!1},reducers:{setMysteryGames:(e,t)=>{e.games=t.payload.games,e.triggered=!1},setCanBeShown:(e,t)=>{e.canBeShown=t.payload.canBeShown,e.game=t.payload.game},clickMysteryGame:e=>{e.game=null,e.games=[],e.triggered=!0,e.canBeShown=!1}}}),d=e=>e.mystery.game,g=e=>e.mystery.triggered,u=e=>e.mystery.canBeShown,m=c,{setMysteryGames:p,clickMysteryGame:f,setCanBeShown:y}=c.actions;let v=!1;"undefined"!=typeof window&&((0,l.Zv)({actionCreator:n.Xy,effect:async(e,{getState:t,dispatch:a,unsubscribe:o,condition:s})=>{const i=t(),l=(0,n.wu)(i),c=(0,n.xp)(i),d=(0,r.fn)(i),g=function(e,t){return"true"===new URLSearchParams(t).get("force_mystery")||!["GB","NL","CA"].includes(e)&&((!navigator?.connection?.effectiveType||"4g"===navigator?.connection?.effectiveType)&&(!(navigator?.hardwareConcurrency<8)&&!!document.createElement("canvas").getContext("webgl2",{failIfMajorPerformanceCaveat:!0})))}(l,d);if(v=g,o(),v){const e=async()=>{try{const e=await fetch(`https://mystery-game-tile.poki.io/v0/mystery-game?device=${c}&geo=${l}`),t=(await e.json()).filter((e=>{const{device_category:t}=e;return t===c||"any"===t}));if(0===t.length)return void a(p({games:[]}));const o=t.map((e=>{const t=btoa(`${e.path}/${e.orientation||"both"}`);return{...e,path:t}}));a(p({games:o}))}catch(e){}};"function"==typeof requestIdleCallback?requestIdleCallback(e,{timeout:1e4}):e();const t=setInterval(e,3e5);await s(f.match),clearInterval(t)}}}),(0,l.Zv)({matcher:(0,o.i0)(s.lh.endpoints.getGame.matchFulfilled,s.lh.endpoints.getCategory.matchFulfilled,s.lh.endpoints.getHomepage.matchFulfilled),effect:(e,{getState:t,dispatch:a,unsubscribe:o})=>{const n=t();if(!v)return void o();const s=(e=>e.mystery.games)(n);if(s.length>0){const e=(0,i.K5)(n),t=(0,i.Vv)(n),o=(0,i.N2)(n),r=(0,i.Qk)(n);if("category"===e&&0===o.games.length)return void a(y({canBeShown:!1,game:null}));const l=s.filter((a=>{const{categories:n=[]}=a;return 0===n.length||("game"===e?t.categories.some((({id:e})=>n.includes(e))):"category"===e&&n.includes(o.id))}));if(0===l.length)return void a(y({canBeShown:!1,game:null}));let c=0;for(let e=0;e<r.length;e++)c+=r.charCodeAt(e);a(y({canBeShown:!0,game:l[c%l.length]}))}}}))},48554:(e,t,a)=>{a.d(t,{Ay:()=>fe,Br:()=>A,Co:()=>I,FK:()=>re,Kj:()=>oe,QE:()=>W,QX:()=>ee,Rk:()=>Z,TQ:()=>T,UO:()=>Y,cD:()=>j,gO:()=>K,h8:()=>G,hQ:()=>X,iG:()=>P,iw:()=>U,kK:()=>D,kj:()=>ne,lT:()=>ae,lh:()=>M,m$:()=>V,on:()=>B,pT:()=>ie,qA:()=>q,u9:()=>E,vA:()=>R,wZ:()=>L,wj:()=>se,yd:()=>J,yq:()=>C,zM:()=>te,zO:()=>le});var o=a(20038),n=a(8120),s=a(5298),i=a(42891),r=a(89385),l=a(15203),c=a(40890),d=a(13150),g=a(46493),u=a(17782),m=a(16536),p=a(73934),f=a(83228),y=a(46278),v=a(65995),h=a(25733);const _={isFullscreen:!1,wasFullscreen:!1,showAdStatus:!1,adStatusEvent:"",adDuration:0,adCurrentTime:0,loadingFinished:!1,lastCloudSaveTimestamp:0,externalLinkURL:void 0},w=(0,y.T5)(),k=`${w}/players/gamesave`,S=`${w}/auth/issue-token`,b=(0,o.Z0)({name:"game",initialState:_,reducers:{setFullscreen:(e,t)=>{e.isFullscreen=t.payload.toggle,e.wasFullscreen=e.wasFullscreen||t.payload.toggle},setGameLoadingFinished:(e,t)=>{e.loadingFinished=t.payload},setPubHostData:(e,t)=>{const{gameId:a,data:o}=t.payload;e[a]={...e[a],pubHostData:o}},showAdStatus:e=>{e.showAdStatus=!0},hideAdStatus:e=>{e.showAdStatus=!1},setAdStatusEvent:(e,t)=>{e.adStatusEvent=t.payload.event},setAdDurationAndProgress:(e,t)=>{e.adDuration=t.payload.duration,e.adCurrentTime=t.payload.currentTime},setLastCloudSaveTimestamp:(e,t)=>{e.lastCloudSaveTimestamp=t.payload},setExternalLinkURL:(e,t)=>{e.externalLinkURL=t.payload.url}}}),A=(0,u.A)("game/boot"),L=(0,u.A)("game/receive_game_event"),C=(0,u.A)("game/receive_sdk_details"),M=(0,u.A)("game/request_full_screen"),P=(0,u.A)("game/pub_host_initialized"),G=(0,u.A)("game/set_poki_url_params"),T=(0,u.A)("game/receive_command"),D=(0,u.A)("game/generate_screenshot"),E=(0,u.A)("game/receive_screenshot"),F=(0,u.A)("game/receive_score"),O=(0,u.A)("game/forward_game_event"),B=(0,u.A)("game/fetch_save_game"),z=(0,o.VP)("game/mutate_save_game"),I=(0,u.A)("game/cloud_save_game_script_error"),x=(0,u.A)("game/poki_accounts_open_auth_panel"),N=(0,u.A)("game/poki_accounts_get_user_token"),$=(0,u.A)("game/open_external_link"),{setFullscreen:K,setGameLoadingFinished:Z,setPubHostData:U,showAdStatus:R,hideAdStatus:V,setAdStatusEvent:j,setAdDurationAndProgress:q,setLastCloudSaveTimestamp:H,setExternalLinkURL:X}=b.actions,Q=(0,n.Mz)(s.Vv,(e=>e.game),((e,t)=>t[e&&e.id]||{}));function J(e){const t=Q(e);return t?.pubHostData||null}function W(e){const t=(0,s.Vv)(e);return!!t?.fullscreen}const Y=(0,n.Mz)(s.Vv,i.zS,s.K5,l.Bi,((e,t,a,o)=>"game"===a?"flash"===e?.file?.render_type||e?.alternative_game_enabled||t&&!e?.mobile_available:"mystery"===a&&!o)),ee=e=>e.game.isFullscreen,te=e=>e.game.wasFullscreen,ae=e=>e.game.showAdStatus,oe=e=>e.game.adStatusEvent,ne=e=>e.game.adDuration,se=e=>e.game.adCurrentTime,ie=e=>e.game.loadingFinished,re=e=>e.game.lastCloudSaveTimestamp,le=e=>e.game.externalLinkURL,ce={pubHostInitialized:P,[d.oQ]:L,[d.Oi]:C,[d.AU]:G,[d.zR]:T,[d.RC]:E,[d.Zf]:F,[d.vO]:O,[d.Kt]:x,[d.Xo]:N,[d.W2]:$,fetchSaveGame:B,mutateSaveGame:z,SaveGameMigrator:!0,pokiLoader:!0},de=["localhost","games.poki.com","game-cdn.poki.com"],ge=["pokiMessageEvent","pokiMessageDebug","SaveGameMigrator","pokiLoader"];function ue({event:e,dispatch:t}){const a=function({event:e}){const{type:t}=e.data||{};if(!t||!ce[t]||"function"!=typeof ce[t])return!1;const a=(0,c.aX)(e.origin)||"",o=de.includes(a)||a.endsWith(".poki-gdn.com")||window.location.origin===e.origin,n=document.querySelector('iframe[name="gameFrame"]'),s=n&&n.src.startsWith(e.origin);return o||s}({event:e});if(!a)return;const{content:o,type:n}=e.data;if(ge.includes(n)&&(0,g.F)({category:"sdk",action:"message",data:{content:o,type:n}}),"function"==typeof ce[n]){const a=e.source;t(ce[n]({...o,source:a}))}}(0,m.Zv)({type:i.Xy.type,effect:(e,t)=>{const{dispatch:a}=t;void 0!==window.pokiMessageListener&&window.removeEventListener("message",window.pokiMessageListener),window.pokiMessageBuffer&&window.pokiMessageBuffer.forEach((e=>{ue({event:e,dispatch:a})})),window.addEventListener("message",(e=>{ue({event:e,dispatch:a})}))}});const me=(0,o.zD)("game/push_save_game_to_cloud",(async({gameID:e,saveGameData:t},a)=>{const o=t.playtime||0;try{const n=JSON.stringify({ls:t.ls,idb:t.idb}),s=new Blob([n]).size;let i=n,l=s,c=1,d=!0;try{i=await(0,p.B)(n),l=i.size,c=l/s}catch(e){d=!1,console.error(e)}if(console.info(`[SaveGame] Compression results - Original: ${s/1024}KB, Compressed: ${l/1024}KB, Compression ratio: ${(100*c).toFixed(2)}% of the original size`),l>f.Im)return console.error(`[SaveGame] Game file is too large after compression ${l/1048576}mb`),(0,g.F)({category:"account",action:"gamesaveSizeTooLarge",data:{gameId:e,size:l,originalSize:s,compressionRatio:c}}),void a.dispatch((0,r.hK)({gameID:e,saveGameSize:l}));const u={"X-Poki-Pt":o.toString(),"X-Poki-Api-Version":"v2"};d&&(u["Content-Encoding"]="gzip"),a.dispatch(H(Date.now()));const m=await fetch(`${k}/${e}`,{method:"POST",body:i,credentials:"include",headers:u});if(!m.ok)throw new Error(`Failed to save user games: ${m.status}`);const y=m.headers.get("Etag");y&&window.frames?.gameFrame?.postMessage?.({type:"pokiSetEtag",etag:y},"*"),(0,g.F)({category:"account",action:"gamesaveSuccess",data:{gameId:e,size:l,originalSize:s,compressionRatio:c}});const v=new Date;console.info(`[SaveGame] cloud sync - game: ${e}, at: ${v.toLocaleString()}`)}catch(t){console.error("[SaveGame] error pushing to cloud",t),(0,g.F)({category:"account",action:"gamesaveError",data:{gameId:e,method:"pushSaveGameToCloud",context:"sending gamesave to the cloud",error:t instanceof Error?`${t.name}: ${t.message}`:String(t)}})}}));(0,m.Zv)({type:z.type,effect:(e,t)=>{const a=t.getState(),o=(0,s.Vv)(a)?.id,n=(0,r.Ep)(a),i=(0,r.Fh)(a);if(!n||!o||i.includes(o))return;if((0,f.jJ)(e.payload))return;const l={playtime:parseInt(e.payload.metadata?.playtime||"0",10),ls:e.payload.ls||"",idb:e.payload.idb||""};t.dispatch(me({gameID:o,saveGameData:l}))}});const pe=Math.random().toString(36).substring(2);(0,m.Zv)({actionCreator:r.hK,effect:(e,t)=>{const{saveGameSize:a}=e.payload,o=J(t.getState()),{gameID:n,gameVersion:s}=o||{},i={name:"LargeGameSave",message:`Game state of ${(a/1024/1024).toFixed(2)}MB is too large to sync to Poki User Account (max 1MB allowed)`},r=JSON.stringify({gid:n,vid:s,ve:7,n:i.name,m:i.message,ui:pe}),l=`${y.N8}/ge`;fetch(l,{method:"POST",body:r})}}),(0,m.Zv)({type:x.type,effect:(e,t)=>{const a=t.getState(),o=(0,r.ij)(a),n=(0,s.Vv)(a)?.id,i=e.version||0;if(!o){let o="unknown";switch(i){case 0:o=`sdk-${n}`;break;case 1:o=e.trigger}t.dispatch((0,r.qf)({source:o})),(0,g.F)({category:"account",action:"sdkOpenAuthPanel",data:{source:o,gameID:(0,s.Vv)(a)?.id}})}}}),(0,m.Zv)({type:N.type,effect:async(e,t)=>{const a=t.getState(),o=(0,s.Vv)(a)?.pokifordevs_game_id,n=(0,r.Ep)(a),i=e=>{window.frames?.gameFrame?.postMessage?.({type:"pokiAccountsUserToken",token:null,error:e},"*")};if(!o)return void i("No gameID found");if(!n)return void i("User is not logged in");let l,c;try{l=await fetch(`${S}?game_id=${o}`,{method:"GET",credentials:"include"})}catch(e){return console.error(e),void i("Network error while generating token")}if(l.ok){try{c=await l.json()}catch{return void i("Failed to parse user token")}window.frames?.gameFrame?.postMessage?.({type:"pokiAccountsUserToken",token:c.token},"*")}else i("Failed to generate user token")}}),(0,m.Zv)({type:F.type,effect:(e,t)=>{const{leaderboard:a,score:o,timeOnPage:n}=e.data;let{meta:i}=e.data;const l=t.getState(),c=(0,s.Vv)(l);if(!c||!c.pokifordevs_game_id)return;const d=(0,r.IT)(l);i||(i={time_on_page:Math.round(n)}),(0,v.g)(a,o,i,c.pokifordevs_game_id,d?.identity?.id)}}),(0,m.Zv)({type:O.type,effect:e=>{if(window.pokiBotDetected?.length>0)return;const{payload:t}=e,a=(0,h.v)();t.pageview_id=a.page.pageview_id;const o=`${y.N8}/game-event`;fetch(o,{method:"POST",headers:{"Content-Type":"text/plain"},body:JSON.stringify(t),mode:"no-cors",keepalive:!0,credentials:"omit"}).catch((e=>{console.warn("%cPOKI:%c failed to submit game event","font-weight: bold","",e)}))}}),(0,m.Zv)({type:$.type,effect:(e,t)=>{const{params:{url:a}}=e;if(a&&"string"==typeof a)try{const e=new URL(a);t.dispatch(X({url:e.toString()}))}catch{console.error("Invalid external link URL format:",a)}}}),(0,m.Zv)({type:A.type,effect:(e,t)=>{t.dispatch(X({url:void 0}))}});const fe=b},91323:(e,t,a)=>{a.d(t,{Ay:()=>v,DF:()=>f,Gd:()=>m,LJ:()=>i,n:()=>p});var o=a(20038),n=a(8120),s=a(40890);const i={WEB:"web",APP:"app"},r={mode:i.WEB},l=(0,o.Z0)({name:"site",initialState:r,reducers:{setSite:(e,t)=>{e.site=t.payload.site},setSitesForClient:(e,t)=>{e.sites=t.payload.sites},setLocalisations:(e,t)=>{e.localisations=t.payload.localisations},setSiteMode:(e,t)=>{e.mode=t.payload.mode}}}),{setSite:c,setSitesForClient:d,setLocalisations:g,setSiteMode:u}=l.actions,m=e=>e.site.site,p=e=>e.site.sites,f=e=>e.site.mode,y=((0,n.Mz)(m,(({paths:e})=>({...s.KJ,...e}))),["ar","he"]),v=((0,n.Mz)(m,(({iso_lang:e})=>y.includes(e))),l)}}]);
//# sourceMappingURL=client~main-524ed0a7~8605d61d266462de67dc.js.map